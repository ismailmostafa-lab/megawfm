<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login</title>

<style>
  body{
    font-family: Arial, sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    background:#f3f3f3;
    margin:0;
  }
  .box{
    background:white;
    width:320px;
    padding:25px;
    border-radius:12px;
    box-shadow:0 0 12px rgba(0,0,0,0.12);
    text-align:center;
  }
  h3{
    margin-bottom:20px;
    color:#6f2f90;
  }
  input{
    width:100%;
    margin:10px 0;
    padding:12px;
    font-size:15px;
    border:1px solid #ccc;
    border-radius:7px;
    box-sizing:border-box;
  }
  button{
    width:100%;
    padding:12px;
    font-size:16px;
    background:#6f2f90;
    color:white;
    border:none;
    border-radius:7px;
    cursor:pointer;
    margin-top:10px;
  }
  #msg{
    margin-top:15px;
    font-size:16px;
    font-weight:bold;
  }
</style>

</head>
<body>

<!-- IMPORTANT: NO FORM TAG -->
<div class="box">
  <h3>Login</h3>

  <input type="number" id="id" placeholder="Enter ID" autocomplete="off">
  <input type="password" id="pass" placeholder="Enter Password" autocomplete="off">

  <!-- FORCE BUTTON MODE -->
  <button type="button" onclick="doLogin()">Login</button>

  <p id="msg"></p>
</div>

<script>
  function doLogin(){

    // لازم نمنع أي reload غصب
    event.preventDefault();
    
    const id = document.getElementById("id").value.trim();
    const pass = document.getElementById("pass").value.trim();
    const msg = document.getElementById("msg");

    if(id === "" || pass === ""){
      msg.innerHTML = "Please fill both fields";
      msg.style.color = "red";
      return;
    }

    const url = "https://script.google.com/macros/s/AKfycbwCHjHcNiAFJ68F_GX2XrAsKFe0YkTZgF0AYokY7W3gDq99inb8QF14jAO4IlZiRWR3ng/exec";

    fetch(`${url}?route=login&id=${id}&pass=${pass}`)
      .then(res => res.text())
      .then(data => {

        // protection from auto-redirect
        history.pushState(null, "", location.href);

        if(data === "correct"){
          msg.innerHTML = "Correct ✔️";
          msg.style.color = "green";
        } else {
          msg.innerHTML = "Wrong ❌";
          msg.style.color = "red";
        }
      })
      .catch(()=>{
        msg.innerHTML = "Error connecting!";
        msg.style.color = "red";
      });
  }

  // stop any accidental back navigation → 404 protection
  window.onpopstate = function () {
    history.pushState(null, "", location.href);
  };
</script>

</body>
</html>
