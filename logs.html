<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Attendance Logs</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  background:#f5f2fc;
  font-family:'Cairo',sans-serif;
}

.header{
  background:linear-gradient(135deg,#A666B0,#573B92);
  padding:22px;
  text-align:center;
  color:#fff;
  font-size:20px;
  font-weight:700;
}

.container{
  max-width:600px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:18px;
  box-shadow:0 4px 18px rgba(0,0,0,0.1);
}

.label{
  font-size:14px;
  margin-top:14px;
}
.input, select{
  width:100%;
  padding:14px;
  margin-top:6px;
  border-radius:12px;
  border:1px solid #ccc;
}

.btn{
  width:100%;
  margin-top:22px;
  padding:14px;
  font-size:16px;
  color:#fff;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#A666B0,#573B92);
  cursor:pointer;
}

#msg{
  text-align:center;
  margin-top:12px;
  font-weight:600;
}
</style>
</head>

<body>

<div class="header">Attendance Log — Submit Request</div>

<div class="container">

  <label class="label">Date</label>
  <input id="date" type="date" class="input">

  <label class="label">Request Type</label>
  <select id="req" class="input">
    <option value="">Select</option>
    <option value="Permission">Permission</option>
    <option value="Work From Home">Work From Home</option>
    <option value="Late Arrival">Late Arrival</option>
  </select>

  <button class="btn" onclick="save()">Submit</button>

  <div id="msg"></div>

</div>

<script>
const API = "PUT_YOUR_NEW_WEB_APP_URL_HERE";

if(!localStorage.getItem("ID")){
  location.href = "index.html";
}

async function save(){
  const date = document.getElementById("date").value;
  const req = document.getElementById("req").value;
  const msg = document.getElementById("msg");

  if(!date || !req){
    msg.style.color="red";
    msg.textContent="Please fill all fields";
    return;
  }

  msg.style.color="black";
  msg.textContent="Saving...";

  try{
    const r = await fetch(API, {
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({
        action:"request",
        name: localStorage.getItem("name"),
        date: date,
        request_type: req,
        added_by: localStorage.getItem("ID")
      })
    });

    const j = await r.json();

    if(j.status === "saved"){
      msg.style.color="green";
      msg.textContent="Saved ✔";
    } else {
      msg.style.color="red";
      msg.textContent="Error!";
    }

  } catch(err){
    msg.style.color="red";
    msg.textContent="Connection Error";
  }
}
</script>

</body>
</html>
